# OB-003-A-001: Crear entidad Copropiedad con TypeORM

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-003 - Gestion de Copropiedades y Apartamentos |
| Story | OB-003-A - Modelo y gestion de copropiedades |
| Status | pending |
| Priority | critical |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, entidad, typeorm, copropiedad |
| Depends on | OB-001-B-003 |
| Assigned | unassigned |

## Descripcion

Crear la entidad Copropiedad con decoradores TypeORM incluyendo todos los campos necesarios para representar una unidad residencial, heredando campos de auditoria de BaseEntity.

## Contexto Tecnico

### Archivos afectados
- `apps/api/src/entities/copropiedad.entity.ts`
- `apps/api/src/entities/torre.entity.ts`
- `apps/api/src/types/copropiedad.ts`

### Enfoque tecnico
Definir entidad con decoradores TypeORM para campos de identificacion, ubicacion basica, configuracion y auditoria.

## Criterios de Aceptacion

- [ ] Entidad Copropiedad creada con decoradores TypeORM
- [ ] Campos de identificacion: nombre, nit (opcional)
- [ ] Campos de ubicacion: direccion, ciudad
- [ ] Campo de configuracion: cantidadUnidades
- [ ] Campo isActive para soft delete
- [ ] Hereda campos de auditoria de BaseEntity
- [ ] Migracion creada y aplicada

## Notas de Implementacion

Entidad Copropiedad con TypeORM:
```typescript
import { Entity, Column, OneToMany, Index } from 'typeorm';
import { BaseEntity } from './base.entity';
import { Apartamento } from './apartamento.entity';
import { Torre } from './torre.entity';
import { CopropiedadAdmin } from './copropiedad-admin.entity';
import { Objetivo } from './objetivo.entity';

@Entity('copropiedades')
export class Copropiedad extends BaseEntity {
  @Column()
  nombre: string;

  @Column({ nullable: true, unique: true })
  @Index()
  nit: string;

  @Column()
  direccion: string;

  @Column()
  ciudad: string;

  @Column()
  cantidadUnidades: number;

  @Column({ default: true })
  isActive: boolean;

  // Relaciones
  @OneToMany(() => Apartamento, (apt) => apt.copropiedad)
  apartamentos: Apartamento[];

  @OneToMany(() => Torre, (torre) => torre.copropiedad)
  torres: Torre[];

  @OneToMany(() => CopropiedadAdmin, (admin) => admin.copropiedad)
  administradores: CopropiedadAdmin[];

  @OneToMany(() => Objetivo, (obj) => obj.copropiedad)
  objetivos: Objetivo[];
}
```

Entidad Torre:
```typescript
import { Entity, Column, ManyToOne, OneToMany, JoinColumn } from 'typeorm';
import { BaseEntity } from './base.entity';
import { Copropiedad } from './copropiedad.entity';
import { Apartamento } from './apartamento.entity';

@Entity('torres')
export class Torre extends BaseEntity {
  @Column()
  nombre: string;

  @Column()
  copropiedadId: string;

  @ManyToOne(() => Copropiedad, (cop) => cop.torres)
  @JoinColumn({ name: 'copropiedadId' })
  copropiedad: Copropiedad;

  @OneToMany(() => Apartamento, (apt) => apt.torre)
  apartamentos: Apartamento[];
}
```

## Testing

- [ ] Migracion se aplica sin errores
- [ ] Se puede crear copropiedad con todos los campos
- [ ] NIT es unico cuando se proporciona
- [ ] Relaciones funcionan correctamente
