# OB-003-A-004: Implementar configuracion de torres/bloques

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-003 - Gestion de Copropiedades y Apartamentos |
| Story | OB-003-A - Modelo y gestion de copropiedades |
| Status | pending |
| Priority | medium |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, api, torres, configuracion |
| Depends on | OB-003-A-001 |
| Assigned | unassigned |

## Descripcion

Implementar la gestion de torres o bloques dentro de una copropiedad. Las torres son opcionales pero permiten organizar mejor los apartamentos en conjuntos grandes.

## Contexto Tecnico

### Archivos afectados
- `src/api/routes/torres.routes.ts`
- `src/api/controllers/torres.controller.ts`
- `src/services/torre.service.ts`

### Enfoque tecnico
CRUD anidado bajo la copropiedad. Las torres son opcionales - los apartamentos pueden existir sin torre.

## Criterios de Aceptacion

- [ ] CRUD de torres bajo /api/copropiedades/:id/torres
- [ ] Torres son opcionales en una copropiedad
- [ ] Nombre de torre unico dentro de la copropiedad
- [ ] No se puede eliminar torre con apartamentos
- [ ] Solo admins de la copropiedad pueden gestionar torres

## Notas de Implementacion

Endpoints:
```
POST   /api/copropiedades/:copId/torres
GET    /api/copropiedades/:copId/torres
PATCH  /api/copropiedades/:copId/torres/:id
DELETE /api/copropiedades/:copId/torres/:id
```

Request crear torre:
```json
{
  "nombre": "Torre A"
}
```

Validaciones:
- Nombre unico dentro de la copropiedad
- No eliminar si tiene apartamentos asociados
- Verificar que el usuario es admin de la copropiedad

## Testing

- [ ] CRUD de torres funciona
- [ ] Nombre duplicado en misma copropiedad falla
- [ ] Delete con apartamentos falla
- [ ] Admin de otra copropiedad no puede gestionar
