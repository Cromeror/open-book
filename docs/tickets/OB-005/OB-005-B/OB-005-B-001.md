# OB-005-B-001: Definir configuracion por tipo de actividad

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-005 - Actividades de Recaudo |
| Story | OB-005-B - Tipos y configuracion de actividades |
| Status | pending |
| Priority | medium |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, configuracion, tipos |
| Depends on | OB-005-A-001 |
| Assigned | unassigned |

## Descripcion

Definir la configuracion especifica para cada tipo de actividad, permitiendo campos adicionales segun el tipo (precio de boleta para rifas, monto sugerido para donaciones, etc.).

## Contexto Tecnico

### Archivos afectados
- `apps/api/src/entities/actividad.entity.ts` (agregar campo configuracion)
- `apps/api/src/types/actividad-config.ts`
- `apps/api/src/config/actividad-tipos.ts`

### Enfoque tecnico
Campo JSONB con TypeORM para configuracion flexible. Cada tipo tiene un schema de configuracion definido con Zod.

## Criterios de Aceptacion

- [ ] Campo configuracion (JSONB) en entidad Actividad
- [ ] Schema de configuracion por tipo definido con Zod
- [ ] Configuracion se valida segun el tipo
- [ ] Tipos soportados: RIFA, DONACION, EVENTO, VENTA, CUOTA, OTRO

## Notas de Implementacion

Agregar a entidad Actividad:
```typescript
@Entity('actividades')
export class Actividad extends BaseEntity {
  // ... campos existentes

  @Column({ type: 'jsonb', default: '{}' })
  configuracion: Record<string, any>;
}
```

Configuraciones por tipo con Zod:
```typescript
interface RifaConfig {
  precioBoleta: number;
  premios?: string[];
  fechaSorteo?: Date;
}

interface DonacionConfig {
  montoSugerido?: number;
  montoMinimo?: number;
}

interface EventoConfig {
  precioEntrada?: number;
  capacidadMaxima?: number;
  ubicacion?: string;
}

interface CuotaConfig {
  montoCuota: number;
  esMensual: boolean;
}

const TIPO_CONFIG_SCHEMAS: Record<TipoActividad, ZodSchema> = {
  RIFA: z.object({
    precioBoleta: z.number().positive(),
    premios: z.array(z.string()).optional(),
    fechaSorteo: z.coerce.date().optional()
  }),
  DONACION: z.object({
    montoSugerido: z.number().positive().optional(),
    montoMinimo: z.number().positive().optional()
  }),
  EVENTO: z.object({
    precioEntrada: z.number().positive().optional(),
    capacidadMaxima: z.number().int().positive().optional(),
    ubicacion: z.string().optional()
  }),
  CUOTA: z.object({
    montoCuota: z.number().positive(),
    esMensual: z.boolean()
  }),
  VENTA: z.object({
    descripcion: z.string().optional()
  }),
  OTRO: z.record(z.unknown()) // Acepta cualquier configuracion
};
```

## Testing

- [ ] Configuracion se guarda como JSONB
- [ ] Validacion de schema por tipo funciona
- [ ] Configuracion invalida es rechazada
- [ ] Tipo OTRO acepta cualquier configuracion
