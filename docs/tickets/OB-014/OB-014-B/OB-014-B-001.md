# OB-014-B-001: Crear DashboardLayout con sidebar dinamico

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-014 - Configuracion de Vistas por Permisos y Modulos |
| Story | OB-014-B - Layout dinamico basado en permisos |
| Status | done |
| Priority | high |
| Created | 2026-01-05 |
| Updated | 2026-01-06 |
| Labels | task, frontend, layout |
| Depends on | OB-014-A-001 |
| Assigned | unassigned |

## Descripcion

Crear el componente de layout principal para el dashboard, con sidebar lateral y header superior que se adapta dinamicamente segun los modulos y permisos del usuario.

## Contexto Tecnico

### Archivos creados/modificados
- `apps/web/src/components/layout/DashboardShell.tsx` - Client component principal
- `apps/web/src/components/layout/Sidebar.tsx` - Sidebar con navegacion dinamica
- `apps/web/src/components/layout/Header.tsx` - Header con info de usuario
- `apps/web/src/components/layout/Breadcrumbs.tsx` - Navegacion contextual
- `apps/web/src/components/layout/Icon.tsx` - Componente de iconos dinamico
- `apps/web/src/components/layout/index.ts` - Exports
- `apps/web/src/app/(dashboard)/layout.tsx` - Server Component layout
- `apps/web/src/lib/nav-config.ts` - Configuracion de navegacion
- `apps/web/src/lib/nav-filter.server.ts` - Filtrado server-side

### Enfoque tecnico
- Server-First: Navegacion filtrada en servidor antes de enviar al cliente
- Layout usa route group `(dashboard)` para rutas protegidas
- Sidebar responsive con overlay en mobile
- Permisos verificados via ServerPermissions

## Criterios de Aceptacion

- [x] Sidebar de 250px con navegacion dinamica
- [x] Header con logo, titulo y menu de usuario
- [x] Area de contenido principal con padding
- [x] Estado de sidebar controlado por toggle
- [x] Responsive: sidebar drawer en mobile

## Implementacion Final

```typescript
// apps/web/src/app/(dashboard)/layout.tsx
import { redirect } from 'next/navigation';
import { DashboardShell } from '@/components/layout';
import { filterNavItems, getUserForHeader } from '@/lib/nav-filter.server';
import { getServerPermissions } from '@/lib/permissions.server';

export default async function DashboardLayout({ children }) {
  const permissions = await getServerPermissions();
  if (!permissions.isAuthenticated) {
    redirect('/login');
  }
  const navItems = filterNavItems(permissions);
  const user = getUserForHeader(permissions);
  return (
    <DashboardShell user={user} navItems={navItems} isSuperAdmin={permissions.isSuperAdmin}>
      {children}
    </DashboardShell>
  );
}
```

## Testing

- [x] Layout renderiza correctamente
- [x] Sidebar colapsa y expande
- [x] Contenido se ajusta al cambio de sidebar
- [x] Build pasa sin errores
