# OB-014-D-006: Scaffold modulo Estados de Cuenta

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-014 - Configuracion de Vistas por Permisos y Modulos |
| Story | OB-014-D - Scaffolding de modulos con permisos |
| Status | pending |
| Priority | high |
| Created | 2026-01-06 |
| Updated | 2026-01-06 |
| Labels | task, frontend, scaffolding, estados-cuenta, privacidad |
| Depends on | OB-014-C |
| Implementa | OB-011 (estructura base) |

## Descripcion

Crear la estructura de archivos para el modulo de Estados de Cuenta y Visibilidad con validacion de permisos configurada. Este scaffold sera el punto de partida para implementar OB-011.

**LEGAL**: Ley 1581/2012 (Habeas Data) - Los cambios de visibilidad requieren consentimiento o justa causa documentada.

## Estructura de Archivos

```
apps/web/src/app/(dashboard)/estados-cuenta/
├── page.tsx                    # Mi estado de cuenta
├── configuracion/
│   └── page.tsx                # Configurar privacidad (publico/privado)
├── publicos/
│   └── page.tsx                # Ver estados de cuenta publicos
└── _components/
    └── .gitkeep
```

## Permisos por Pagina

| Pagina | Guard | Permiso | Nota |
|--------|-------|---------|------|
| /estados-cuenta | requireModule | estados_cuenta | Ver mi propio estado |
| /estados-cuenta/configuracion | requirePermission | configuracion:update | Cambio via PQR |
| /estados-cuenta/publicos | Custom | - | Solo si soy publico |

## Logica Especial

### /estados-cuenta/publicos
Esta pagina tiene logica especial:
- Solo visible si el usuario actual tiene visibilidad PUBLICA
- Muestra estados de cuenta de otros residentes que tambien son publicos
- Reciprocidad: solo ves si te ven

```typescript
// Pseudocodigo de verificacion
const permissions = await getServerPermissions();
const miVisibilidad = await getVisibilidadUsuario(permissions.userId);

if (miVisibilidad !== 'PUBLICA') {
  redirect('/estados-cuenta'); // No puede ver estados publicos
}
```

## Criterios de Aceptacion

- [ ] Estructura de carpetas creada
- [ ] Pagina principal muestra mi estado de cuenta
- [ ] Configuracion indica que cambios van via PQR
- [ ] Pagina publica verifica reciprocidad
- [ ] Build pasa sin errores

## Referencia de Implementacion

La logica de negocio se implementara en **OB-011: Visibilidad de Estados de Cuenta**:
- Consentimiento inicial al registrarse
- Cambios de visibilidad via PQR
- Reciprocidad en visualizacion
- Admin puede cambiar con justa causa
- Notificacion obligatoria al residente
