# OB-001-C-002: Configurar base de datos de testing

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-001 - Configuracion e Infraestructura del Proyecto |
| Story | OB-001-C - Configuracion de testing y CI/CD |
| Status | pending |
| Priority | high |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, testing, database |
| Depends on | OB-001-B-001, OB-001-C-001 |
| Assigned | unassigned |

## Descripcion

Configurar una base de datos separada para tests que permita ejecutar tests de integracion de forma aislada sin afectar los datos de desarrollo. Incluir mecanismo de limpieza entre tests.

## Contexto Tecnico

### Archivos afectados
- `.env.test`
- `tests/setup.ts`
- `tests/helpers/db.ts`
- `docker-compose.test.yml` (opcional)

### Enfoque tecnico
Crear base de datos separada para tests, configurar limpieza automatica entre tests, y proveer helpers para setup/teardown de datos.

## Criterios de Aceptacion

- [ ] Base de datos de test configurada (openbook_test)
- [ ] .env.test con DATABASE_URL de testing
- [ ] Helper para limpiar base de datos entre tests
- [ ] Migraciones se ejecutan antes de tests
- [ ] Tests no afectan base de datos de desarrollo

## Notas de Implementacion

- Usar DATABASE_URL diferente en .env.test
- Crear helper `resetDatabase()` que trunca todas las tablas
- Ejecutar migraciones en beforeAll global
- Considerar transacciones para rollback automatico
- Para CI, usar servicio de PostgreSQL de GitHub Actions

## Testing

- [ ] Tests se ejecutan en base de datos separada
- [ ] La base de datos se limpia entre test suites
- [ ] No hay conflictos con datos de desarrollo
