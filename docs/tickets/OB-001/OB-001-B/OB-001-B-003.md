# OB-001-B-003: Crear entidad base con campos de auditoria

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-001 - Configuracion e Infraestructura del Proyecto |
| Story | OB-001-B - Configuracion de base de datos y ORM |
| Status | done |
| Priority | high |
| Created | 2025-12-31 |
| Updated | 2026-01-05 |
| Labels | task, auditoria, entidad, transparencia |
| Depends on | OB-001-B-002 |
| Assigned | unassigned |

## Descripcion

Definir los campos de auditoria que seran comunes a todas las entidades del sistema. Estos campos son fundamentales para cumplir con los principios de transparencia: trazabilidad, inmutabilidad y auditoria.

## Contexto Tecnico

### Archivos afectados
- `apps/api/src/entities/base.entity.ts` (entidad base abstracta)
- `apps/api/src/types/audit.ts` (tipos de auditoria)

### Enfoque tecnico
Crear una entidad abstracta base con decoradores TypeORM que incluira campos estandar de auditoria: createdAt, updatedAt, createdBy, updatedBy, deletedAt, deletedBy. Usar subscribers de TypeORM para poblar automaticamente estos campos.

## Criterios de Aceptacion

- [x] Entidad base abstracta con campos de auditoria definidos
- [x] Decoradores @CreateDateColumn, @UpdateDateColumn configurados
- [x] Campo deletedAt para soft delete (inmutabilidad)
- [x] Subscriber de TypeORM para poblar campos automaticamente
- [x] Tipos TypeScript para campos de auditoria
- [x] Documentacion de los campos de auditoria

## Notas de Implementacion

Ejemplo de entidad base con TypeORM:

```typescript
import {
  PrimaryGeneratedColumn,
  CreateDateColumn,
  UpdateDateColumn,
  DeleteDateColumn,
  Column
} from 'typeorm';

export abstract class BaseEntity {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;

  @Column({ nullable: true })
  createdBy: string;

  @Column({ nullable: true })
  updatedBy: string;

  @DeleteDateColumn()
  deletedAt: Date;

  @Column({ nullable: true })
  deletedBy: string;
}
```

- Usar subscriber de TypeORM para asignar createdBy/updatedBy del contexto de usuario

## Testing

- [ ] Los campos se crean automaticamente al insertar registros
- [ ] updatedAt se actualiza automaticamente en updates
- [ ] El subscriber asigna correctamente createdBy/updatedBy
