# OB-002-A-004: Implementar hash de contrasena con bcrypt

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-002 - Gestion de Usuarios y Autenticacion |
| Story | OB-002-A - Modelo de usuario y registro |
| Status | done |
| Priority | critical |
| Created | 2025-12-31 |
| Updated | 2026-01-05 |
| Labels | task, seguridad, bcrypt |
| Depends on | OB-002-A-002 |
| Assigned | unassigned |

## Descripcion

Implementar el hashing seguro de contrasenas usando bcrypt antes de almacenarlas en la base de datos. Las contrasenas NUNCA deben almacenarse en texto plano.

## Contexto Tecnico

### Archivos afectados
- `src/utils/password.ts`
- `src/services/auth.service.ts`
- `package.json` (dependencia bcrypt)

### Enfoque tecnico
Crear utilidades para hashear y comparar contrasenas usando bcrypt con un numero apropiado de salt rounds.

## Criterios de Aceptacion

- [x] bcrypt instalado como dependencia
- [x] Funcion hashPassword(password) implementada
- [x] Funcion comparePassword(password, hash) implementada
- [x] Salt rounds configurables via variable de entorno
- [x] Las contrasenas se hashean antes de guardar en BD

## Notas de Implementacion

```typescript
import bcrypt from 'bcrypt';

const SALT_ROUNDS = parseInt(process.env.BCRYPT_SALT_ROUNDS || '12');

export async function hashPassword(password: string): Promise<string> {
  return bcrypt.hash(password, SALT_ROUNDS);
}

export async function comparePassword(
  password: string,
  hash: string
): Promise<boolean> {
  return bcrypt.compare(password, hash);
}
```

- Usar minimo 10-12 salt rounds
- bcrypt es async, usar await
- Considerar argon2 como alternativa mas moderna

## Testing

- [x] hashPassword genera hash diferente al password original
- [x] El mismo password genera hashes diferentes (por salt)
- [x] comparePassword retorna true para match correcto
- [x] comparePassword retorna false para match incorrecto
