# OB-010-B-003: Alertas de PQR proximos a vencer

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-010 - Sistema de PQR |
| Story | OB-010-B - Gestion y respuesta de PQR |
| Status | pending |
| Priority | medium |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, alertas, vencimiento |
| Depends on | OB-010-B-001, OB-013 |
| Assigned | unassigned |

## Descripcion

Implementar sistema de alertas para PQR proximos a vencer y vencidos.

## Criterios de Aceptacion

- [ ] Notificacion cuando faltan 3 dias
- [ ] Notificacion cuando vence
- [ ] Dashboard muestra indicadores de urgencia
- [ ] Email a administradores con resumen

## Notas de Implementacion

Job programado diario:
```typescript
async function verificarVencimientosPQR() {
  // PQR que vencen en 3 dias
  const proximosAVencer = await typeorm.pQR.findMany({
    where: {
      estado: { in: ['RADICADA', 'EN_PROCESO'] },
      fechaLimite: {
        gte: new Date(),
        lte: addDays(new Date(), 3)
      }
    }
  });

  // Notificar a admins
  for (const pqr of proximosAVencer) {
    await notificationService.send({
      tipo: 'PQR_PROXIMO_VENCER',
      pqrId: pqr.id,
      diasRestantes: differenceInDays(pqr.fechaLimite, new Date())
    });
  }
}
```

## Testing

- [ ] Alertas se envian en momento correcto
- [ ] No se duplican alertas
- [ ] Admins reciben notificacion
