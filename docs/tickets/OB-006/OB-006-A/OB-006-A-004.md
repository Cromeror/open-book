# OB-006-A-004: Implementar registro masivo de compromisos

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-006 - Compromisos de Aporte |
| Story | OB-006-A - Modelo y CRUD de compromisos |
| Status | pending |
| Priority | medium |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, api, bulk, importacion |
| Depends on | OB-006-A-003 |
| Assigned | unassigned |

## Descripcion

Implementar funcionalidad para crear compromisos para multiples apartamentos en una sola operacion. Util para cuotas donde todos los apartamentos se comprometen al mismo monto.

## Contexto Tecnico

### Archivos afectados
- `src/api/routes/compromisos.routes.ts`
- `src/api/controllers/compromisos.controller.ts`
- `src/services/compromiso.service.ts`

### Enfoque tecnico
Endpoint bulk que acepta lista de apartamentos o filtros, y crea compromisos para todos en transaccion.

## Criterios de Aceptacion

- [ ] POST /api/.../actividades/:id/compromisos/bulk implementado
- [ ] Acepta lista de apartamentos o "todos"
- [ ] Mismo monto para todos o montos individuales
- [ ] Transaccion: todo o nada
- [ ] Resumen de creados/omitidos/errores

## Notas de Implementacion

Request - todos con mismo monto:
```
POST /api/.../actividades/:actId/compromisos/bulk
Body: {
  "apartamentos": "TODOS",  // o "TORRE_A" o lista de IDs
  "montoComprometido": 100000,
  "observaciones": "Cuota extraordinaria marzo"
}
```

Request - montos individuales:
```
POST /api/.../actividades/:actId/compromisos/bulk
Body: {
  "compromisos": [
    { "apartamentoId": "uuid1", "montoComprometido": 100000 },
    { "apartamentoId": "uuid2", "montoComprometido": 150000 }
  ]
}
```

Response:
```json
{
  "resumen": {
    "total": 120,
    "creados": 115,
    "omitidos": 5,
    "errores": 0
  },
  "omitidos": [
    { "apartamentoId": "uuid", "numero": "101", "razon": "Ya existe compromiso" }
  ],
  "errores": []
}
```

La operacion omite (no falla) apartamentos con compromiso existente.

## Testing

- [ ] Bulk crea compromisos para todos los apartamentos
- [ ] Apartamentos con compromiso existente se omiten
- [ ] Transaccion funciona (rollback en error critico)
- [ ] Resumen es preciso
