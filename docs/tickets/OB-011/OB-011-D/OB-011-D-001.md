# OB-011-D-001: Implementar cambio administrativo de visibilidad

## Metadata

| Campo | Valor |
|-------|-------|
| Epic | OB-011 - Visibilidad de Estados de Cuenta |
| Story | OB-011-D - Gestion administrativa de visibilidad |
| Status | pending |
| Priority | high |
| Created | 2025-12-31 |
| Updated | 2025-12-31 |
| Labels | task, api, admin |
| Depends on | OB-011-B-002 |
| Assigned | unassigned |

## Descripcion

Endpoint para que administradores cambien visibilidad de un residente con justa causa documentada.

## Criterios de Aceptacion

- [ ] POST /api/admin/users/:id/visibility implementado
- [ ] Requiere justificacion detallada
- [ ] Requiere causal predefinida
- [ ] Permite adjuntar soporte documental
- [ ] Notifica obligatoriamente al titular

## Notas de Implementacion

Causales validas (segun SUMMARY.md):
- ORDEN_JUDICIAL
- SOLICITUD_TITULAR (via PQR)
- PROTECCION_DERECHOS
- INCUMPLIMIENTO_TERMINOS

Request:
```json
{
  "newVisibility": "PRIVATE",
  "reason": "COURT_ORDER",
  "justification": "Orden del Juzgado 15 Civil Municipal de Bogota, radicado 2025-00123",
  "supportDocumentUrl": "/uploads/supporting-docs/court-order-2025-00123.pdf"
}
```

Response:
```json
{
  "success": true,
  "change": {
    "user": "usuario@ejemplo.com",
    "previousVisibility": "PUBLIC",
    "newVisibility": "PRIVATE",
    "reason": "COURT_ORDER",
    "changedBy": "admin@copropiedad.com",
    "changedAt": "2025-01-20T10:00:00Z"
  },
  "notification": {
    "sent": true,
    "method": "EMAIL"
  }
}
```

## Testing

- [ ] Solo admin puede usar
- [ ] Sin justificacion falla
- [ ] Causal invalida falla
- [ ] Notificacion se envia
